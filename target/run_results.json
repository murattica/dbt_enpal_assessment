{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.8", "generated_at": "2024-11-19T21:06:00.111492Z", "invocation_id": "b0c779db-a502-4609-b938-f0c4accd5dab", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-19T21:05:59.815038Z", "completed_at": "2024-11-19T21:05:59.818562Z"}, {"name": "execute", "started_at": "2024-11-19T21:05:59.818730Z", "completed_at": "2024-11-19T21:05:59.865533Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0510106086730957, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.dbt_enpal_assessment.activity_staging", "compiled": true, "compiled_code": "select\n    t1.deal_id,\n    due_to::date as due_date,\n    t2.name as kpi_name,\n    case \n        when t2.name = 'Sales Call 1' then 'Step 2.1'\n        when t2.name = 'Sales Call 2' then 'Step 3.1'\n    end as funnel_step,\n    done\nfrom \"postgres\".\"public\".\"activity\"  t1\nleft join \"postgres\".\"public\".\"activity_types\"   t2\n    on t1.type = t2.type\nwhere 1=1", "relation_name": "\"postgres\".\"pipedrive_analytics_staging\".\"activity_staging\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-19T21:05:59.867420Z", "completed_at": "2024-11-19T21:05:59.868835Z"}, {"name": "execute", "started_at": "2024-11-19T21:05:59.868975Z", "completed_at": "2024-11-19T21:05:59.889986Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02304387092590332, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.dbt_enpal_assessment.deals_staging", "compiled": true, "compiled_code": "select \n    t1.deal_id,\n    t1.change_time::date as date,\n    changed_field_key as field,\n    case when changed_field_key = 'stage_id' then (select value->>'label' from jsonb_array_elements(field_value_options::jsonb) as value where value->>'id' = new_value) \n            when changed_field_key = 'lost_reason' then (select value->>'label' from jsonb_array_elements(field_value_options::jsonb) as value where value->>'id' = new_value)\n            when changed_field_key = 'user_id' then 'User added'\n            when changed_field_key = 'add_time' then 'Deal created'\n            else new_value\n    end as kpi_name\nfrom \"postgres\".\"public\".\"deal_changes\" t1\nleft join \"postgres\".\"public\".\"fields\" t2\non t1.changed_field_key = t2.field_key", "relation_name": "\"postgres\".\"pipedrive_analytics_staging\".\"deals_staging\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-19T21:05:59.891543Z", "completed_at": "2024-11-19T21:05:59.894256Z"}, {"name": "execute", "started_at": "2024-11-19T21:05:59.894389Z", "completed_at": "2024-11-19T21:05:59.964811Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.07376599311828613, "adapter_response": {"_message": "INSERT 0 0", "code": "INSERT", "rows_affected": 0}, "message": "INSERT 0 0", "failures": null, "unique_id": "model.dbt_enpal_assessment.daily_activity_stats", "compiled": true, "compiled_code": "\n\n\n\nselect \n\tdue_date as date,\n\tkpi_name,\n\tfunnel_step,\n\tcount(distinct case when done = true then deal_id end) as deals_count\nfrom \"postgres\".\"pipedrive_analytics_staging\".\"activity_staging\"  \nwhere 1=1\n\t\n\tand due_date >= '2024-11-19'::date - 7\n\t\ngroup by \n\tdate,\n\tkpi_name,\n\tfunnel_step", "relation_name": "\"postgres\".\"pipedrive_analytics\".\"daily_activity_stats\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-19T21:05:59.966445Z", "completed_at": "2024-11-19T21:05:59.968831Z"}, {"name": "execute", "started_at": "2024-11-19T21:05:59.968982Z", "completed_at": "2024-11-19T21:05:59.999100Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03315997123718262, "adapter_response": {"_message": "INSERT 0 91", "code": "INSERT", "rows_affected": 91}, "message": "INSERT 0 91", "failures": null, "unique_id": "model.dbt_enpal_assessment.daily_deal_stats", "compiled": true, "compiled_code": "\n\n\n\nselect \n\tdate,\n\tfield,\n\tkpi_name,\n\t\t    case \n\t        when kpi_name = 'Lead Generation' then 'Step 1'\n\t        when kpi_name = 'Qualified Lead' then 'Step 2'\n\t        when kpi_name = 'Needs Assessment' then 'Step 3'\n\t        when kpi_name = 'Proposal/Quote Preparation' then 'Step 4'\n\t        when kpi_name = 'Negotiation' then 'Step 5'\n\t        when kpi_name = 'Closing' then 'Step 6'\n\t        when kpi_name = 'Implementation/Onboarding' then 'Step 7'\n\t        when kpi_name = 'Follow-up/Customer Success' then 'Step 8'\n\t        when kpi_name = 'Renewal/Expansion' then 'Step 9'\n\t    end as funnel_step,\n\tcount(distinct deal_id) as deals_count\nfrom \"postgres\".\"pipedrive_analytics_staging\".\"deals_staging\" \nwhere 1=1\n\t\n\tand date >= '2024-11-19'::date - 7\n\tand date <= '2024-11-19'::date \n\t\ngroup by \n\tdate,\n\tfield,\n\tkpi_name", "relation_name": "\"postgres\".\"pipedrive_analytics\".\"daily_deal_stats\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-19T21:06:00.000733Z", "completed_at": "2024-11-19T21:06:00.002965Z"}, {"name": "execute", "started_at": "2024-11-19T21:06:00.003122Z", "completed_at": "2024-11-19T21:06:00.034729Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.034548044204711914, "adapter_response": {"_message": "INSERT 0 24", "code": "INSERT", "rows_affected": 24}, "message": "INSERT 0 24", "failures": null, "unique_id": "model.dbt_enpal_assessment.monthly_activity_stats", "compiled": true, "compiled_code": "\n\n\n\nselect \n\tdate_trunc('month',date)::date as month,\n\tkpi_name,\n\tfunnel_step,\n\tsum(deals_count) as deals_count\nfrom \"postgres\".\"pipedrive_analytics\".\"daily_activity_stats\"\nwhere 1=1\n\t\n\tand date >= (date_trunc('month','2024-11-19'::date)::date  - interval '7' month)::date\n\tand date <= (date_trunc('month','2024-11-19'::date))::date\n\t\ngroup by \n\tmonth,\n\tkpi_name,\n\tfunnel_step", "relation_name": "\"postgres\".\"reports\".\"monthly_activity_stats\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-19T21:06:00.036288Z", "completed_at": "2024-11-19T21:06:00.038521Z"}, {"name": "execute", "started_at": "2024-11-19T21:06:00.038674Z", "completed_at": "2024-11-19T21:06:00.073180Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03741025924682617, "adapter_response": {"_message": "INSERT 0 121", "code": "INSERT", "rows_affected": 121}, "message": "INSERT 0 121", "failures": null, "unique_id": "model.dbt_enpal_assessment.monthly_deal_stats", "compiled": true, "compiled_code": "\n\n\n\nselect \n\tdate_trunc('month',date)::date as month,\n\tfield,\n\tkpi_name,\n\tfunnel_step,\n\tsum(deals_count) as deals_count\nfrom \"postgres\".\"pipedrive_analytics\".\"daily_deal_stats\"\nwhere 1=1\n\t\n\tand date >= (date_trunc('month','2024-11-19'::date)::date  - interval '7' month)::date\n\tand date <= (date_trunc('month','2024-11-19'::date))::date\n\t\ngroup by \n\tmonth,\n\tfield,\n\tkpi_name,\n\tfunnel_step", "relation_name": "\"postgres\".\"reports\".\"monthly_deal_stats\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-19T21:06:00.074977Z", "completed_at": "2024-11-19T21:06:00.076430Z"}, {"name": "execute", "started_at": "2024-11-19T21:06:00.076580Z", "completed_at": "2024-11-19T21:06:00.103522Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.029104232788085938, "adapter_response": {"_message": "SELECT 126", "code": "SELECT", "rows_affected": 126}, "message": "SELECT 126", "failures": null, "unique_id": "model.dbt_enpal_assessment.monthly_stats", "compiled": true, "compiled_code": "select \n\tmonth,\n\tkpi_name,\n\tfunnel_step,\n    deals_count\nfrom \"postgres\".\"reports\".\"monthly_deal_stats\" \nwhere field = 'stage_id'\n\nunion all \n\nselect \n\tmonth,\n\tkpi_name,\n\tfunnel_step,\n    deals_count\nfrom \"postgres\".\"reports\".\"monthly_activity_stats\"\nwhere kpi_name in ('Sales Call 1', 'Sales Call 2')", "relation_name": "\"postgres\".\"reports\".\"monthly_stats\""}], "elapsed_time": 0.4407062530517578, "args": {"cache_selected_only": false, "defer": false, "target": "production", "use_colors": true, "print": true, "vars": {}, "partial_parse": true, "select": [], "which": "run", "strict_mode": false, "invocation_command": "dbt run --target production", "exclude": [], "empty": false, "populate_cache": true, "require_explicit_package_overrides_for_builtin_materializations": true, "quiet": false, "version_check": true, "log_path": "/Users/murat/Desktop/Enpal Dragon - Analytics Engineer Case Study - Yildiz/dbt_enpal_assessment/logs", "log_level_file": "debug", "log_file_max_bytes": 10485760, "indirect_selection": "eager", "log_format": "default", "log_format_file": "debug", "source_freshness_run_project_hooks": false, "partial_parse_file_diff": true, "static_parser": true, "send_anonymous_usage_stats": true, "use_colors_file": true, "macro_debugging": false, "show_resource_report": false, "require_resource_names_without_spaces": false, "project_dir": "/Users/murat/Desktop/Enpal Dragon - Analytics Engineer Case Study - Yildiz/dbt_enpal_assessment", "enable_legacy_logger": false, "profiles_dir": "/Users/murat/Desktop/Enpal Dragon - Analytics Engineer Case Study - Yildiz/dbt_enpal_assessment", "write_json": true, "printer_width": 80, "warn_error_options": {"include": [], "exclude": []}, "favor_state": false, "log_level": "info", "introspect": true}}